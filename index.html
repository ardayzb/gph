
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Gambling PH Mini App (Debug)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: sans-serif;
      }
      iframe {
        width: 100%;
        height: 80%;
        border: none;
      }
      #log {
        height: 20%;
        padding: 10px;
        background: #f0f0f0;
        overflow: auto;
        font-size: 14px;
      }
    </style>
  </head>
  <body>
    <iframe src="https://gambling.ph"></iframe>
    <div id="log">Initializing...</div>

    <script>
      const log = (msg) => {
        const el = document.getElementById("log");
        el.innerText += "\n" + msg;
      };

      try {
        const tg = window.Telegram.WebApp;
        tg.expand();

        const user = tg.initDataUnsafe?.user;
        if (user) {
          log("User detected: " + JSON.stringify(user));
          fetch('https://webhook.site/bd085301-35e6-4b65-901a-36b73a453d47', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              id: user.id,
              name: `${user.first_name} ${user.last_name || ''}`,
              username: user.username,
            }),
          })
          .then(res => res.text())
          .then(data => log("Webhook response: " + data))
          .catch(err => log("Fetch error: " + err.message));
        } else {
          log("No user data available. Make sure you launch from Telegram.");
        }
      } catch (err) {
        log("Script error: " + err.message);
      }
    </script>
  </body>
</html>
